---
/**
 * Orders Page - Static + Client-Side Routing Pattern
 *
 * This page serves as the single entry point for all order views:
 * - /dashboard/orders - Shows order list
 * - /dashboard/orders?id=xxx - Shows order detail
 *
 * The OrdersApp React component handles routing internally via URL search params.
 * This avoids Astro's getStaticPaths() limitation where all IDs must be known at build time.
 *
 * See: documentation/dynamic-routing-decision.md
 */
import { OrdersApp } from '@/components/orders/OrdersApp'
import DashboardLayout from '@/layouts/DashboardLayout.astro'
import type { OrderWithItems } from '@/lib/scoped-queries'

// Mock data for demonstration
// In production, this would be fetched client-side from the API
const mockOrders: OrderWithItems[] = [
	{
		id: 'ord_1234567890abcdef',
		account_id: 'acc_demo',
		created_by_user_id: 'user_alice',
		assigned_to_person_id: 'person_bob',
		status: 'shipped',
		payment_method: 'card',
		subtotal: 2499.0,
		shipping_cost: 0,
		tax_amount: 224.91,
		total: 2723.91,
		shipping_address: '123 Main Street',
		shipping_city: 'San Francisco',
		shipping_state: 'CA',
		shipping_zip: '94105',
		shipping_country: 'US',
		tracking_number: '1Z999AA10123456784',
		carrier: 'UPS',
		estimated_delivery: '2025-12-15T18:00:00Z',
		created_at: '2025-12-01T10:30:00Z',
		updated_at: '2025-12-02T14:22:00Z',
		creator_name: 'Alice Johnson',
		assignee_name: 'Bob Smith',
		items: [
			{
				id: 'item_1',
				order_id: 'ord_1234567890abcdef',
				product_name: 'MacBook Pro 14" M4',
				product_sku: 'MBP-14-M4-16-512',
				quantity: 1,
				unit_price: 2499.0,
				total_price: 2499.0,
				specs: '16GB RAM, 512GB SSD, Space Black',
			},
		],
	},
	{
		id: 'ord_2345678901bcdefg',
		account_id: 'acc_demo',
		created_by_user_id: 'user_alice',
		status: 'pending_leasing_approval',
		payment_method: 'leasing',
		subtotal: 4998.0,
		shipping_cost: 0,
		tax_amount: 449.82,
		total: 5447.82,
		monthly_cost: 226.16,
		shipping_address: '456 Tech Avenue',
		shipping_city: 'Austin',
		shipping_state: 'TX',
		shipping_zip: '78701',
		shipping_country: 'US',
		created_at: '2025-12-05T14:22:00Z',
		creator_name: 'Alice Johnson',
		items: [
			{
				id: 'item_2',
				order_id: 'ord_2345678901bcdefg',
				product_name: 'MacBook Pro 14" M4',
				product_sku: 'MBP-14-M4-16-512',
				quantity: 2,
				unit_price: 2499.0,
				monthly_price: 113.08,
				total_price: 4998.0,
				specs: '16GB RAM, 512GB SSD, Space Black',
			},
		],
	},
	{
		id: 'ord_3456789012cdefgh',
		account_id: 'acc_demo',
		created_by_user_id: 'user_carol',
		assigned_to_person_id: 'person_david',
		status: 'delivered',
		payment_method: 'card',
		subtotal: 1599.0,
		shipping_cost: 0,
		tax_amount: 143.91,
		total: 1742.91,
		shipping_address: '789 Innovation Drive',
		shipping_city: 'Seattle',
		shipping_state: 'WA',
		shipping_zip: '98101',
		shipping_country: 'US',
		tracking_number: '1Z999AA10123456785',
		carrier: 'UPS',
		delivered_at: '2025-11-28T16:45:00Z',
		created_at: '2025-11-20T09:15:00Z',
		updated_at: '2025-11-28T16:45:00Z',
		creator_name: 'Carol Williams',
		assignee_name: 'David Lee',
		items: [
			{
				id: 'item_3',
				order_id: 'ord_3456789012cdefgh',
				product_name: 'iPad Pro 11" M4',
				product_sku: 'IPAD-11-M4-256',
				quantity: 1,
				unit_price: 1599.0,
				total_price: 1599.0,
				specs: '256GB, Wi-Fi + Cellular, Space Gray',
			},
		],
	},
	{
		id: 'ord_4567890123defghi',
		account_id: 'acc_demo',
		created_by_user_id: 'user_alice',
		status: 'processing',
		payment_method: 'card',
		subtotal: 529.0,
		shipping_cost: 15.0,
		tax_amount: 48.96,
		total: 592.96,
		shipping_address: '321 Developer Lane',
		shipping_city: 'New York',
		shipping_state: 'NY',
		shipping_zip: '10001',
		shipping_country: 'US',
		created_at: '2025-12-07T11:00:00Z',
		creator_name: 'Alice Johnson',
		items: [
			{
				id: 'item_4',
				order_id: 'ord_4567890123defghi',
				product_name: 'AirPods Pro (2nd gen)',
				product_sku: 'AIRPODS-PRO-2',
				quantity: 2,
				unit_price: 249.0,
				total_price: 498.0,
			},
			{
				id: 'item_5',
				order_id: 'ord_4567890123defghi',
				product_name: 'Magic Keyboard with Touch ID',
				product_sku: 'MK-TOUCH-ID',
				quantity: 1,
				unit_price: 149.0,
				total_price: 149.0,
			},
		],
	},
]
---

<DashboardLayout title="Orders">
	<div class="space-y-6">
		<div>
			<h1 class="text-3xl font-bold text-foreground">Orders</h1>
			<p class="text-muted-foreground mt-2">View and manage all orders for your team</p>
		</div>

		<!-- OrdersApp handles both list and detail views via URL search params -->
		<OrdersApp orders={mockOrders} client:only="react" />
	</div>
</DashboardLayout>
